
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>040 Processing Data with Pandas &#8212; COM6018 - Data Science with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'materials/tutorials/040_Introducing_Pandas';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="045 Common Pandas Mistakes" href="045_Common_Pandas_Mistakes.html" />
    <link rel="prev" title="035 Some Common Problems" href="035_Some_Common_Problems.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/uos_logo.png" class="logo__image only-light" alt="COM6018 - Data Science with Python - Home"/>
    <img src="../../_static/uos_logo_for_dark.png" class="logo__image only-dark pst-js-only" alt="COM6018 - Data Science with Python - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    The COM6018 module book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lectures</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../wrappers/000_Introduction.html">000 COM6018 Lecture Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrappers/010_wrapper.html">010 Welcome to COM6018</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrappers/015_wrapper.html">015 Getting set up</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrappers/020_wrapper.html">020 Using Git and GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrappers/025_wrapper.html">025 Reading and Writing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrappers/030_wrapper.html">030 Introducing NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrappers/040_wrapper.html">040 Introducing Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrappers/050_wrapper.html">050 Data Visualisation with Matplotlib and Seaborn</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Course Notes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="000_Introduction.html">000 COM6018 Course Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="010_Introducing_Python.html">010 Getting Started with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="015_Further_Python.html">015 Further Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="020_Reading_Data.html">020 Reading and Writing Data Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="030_Introducing_Numpy.html">030 Numerical Computing with NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="035_Some_Common_Problems.html">035 Some Common Problems</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">040 Processing Data with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="045_Common_Pandas_Mistakes.html">045 Common Pandas Mistakes</a></li>
<li class="toctree-l1"><a class="reference internal" href="050_Introducing_Matplotlib.html">050 Exploratory Data Analysis and Visualization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Lab Classes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../labs/000_Introduction.html">000 COM6018 Lab Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/010_python_intro.html">010 Getting Started with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/020_reading_data.html">020 Reading data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/030_introducing_numpy.html">030 Introducing NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/040_working_with_pandas.html">040 Working with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../labs/050_using_matplotlib.html">050 Using Matplotlib</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Solutions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../solutions/000_Introduction.html">000 COM6018 Solutions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions/010_python_intro.html">010 Getting Started with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions/020_reading_data.html">020 Reading data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions/030_introducing_numpy.html">030 Introducing NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions/040_working_with_pandas.html">040 Working with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions/050_using_matplotlib.html">050 Using Matplotlib</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/UOS-COM-6018/COM6018/blob/main/materials/tutorials/040_Introducing_Pandas.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/UOS-COM-6018/COM6018" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/UOS-COM-6018/COM6018/edit/main/materials/tutorials/040_Introducing_Pandas.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/UOS-COM-6018/COM6018/issues/new?title=Issue%20on%20page%20%2Fmaterials/tutorials/040_Introducing_Pandas.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/materials/tutorials/040_Introducing_Pandas.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>040 Processing Data with Pandas</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-pandas">1.1 What is Pandas?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-pandas">1.2 Installing Pandas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-pandas-concepts">1.3 Basic Pandas Concepts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-data">2. Reading Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-csv-data">2.1 Reading CSV Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-json-data">2.2 Reading JSON Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dataframe-object">3. The DataFrame Object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-a-column">3.1 Selecting a Column</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-a-row">3.2 Selecting a Row</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-a-dataframe">3.3 Filtering a DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-or-selecting-columns">3.3.1 Removing or Selecting Columns</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-rows">3.3.2 Selecting Rows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-and-averaging-values">4 Grouping and averaging values</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operating-on-columns">4.1 Operating on columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-data">4.2 Grouping data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-missing-data">5 Dealing with Missing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filling-missing-data-with-a-fixed-value">5.1 Filling missing data with a fixed value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filling-missing-values-using-mean-imputation">5.2 Filling missing values using ‘mean imputation’</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#collating-data">6 Collating data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-dataframes-using-the-merge-method">6.1 Combining DataFrames using the <code class="docutils literal notranslate"><span class="pre">merge</span></code> method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-dataframes-using-the-join-method">6.2 Combining DataFrames using the <code class="docutils literal notranslate"><span class="pre">join</span></code> method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="processing-data-with-pandas">
<h1>040 Processing Data with Pandas<a class="headerlink" href="#processing-data-with-pandas" title="Link to this heading">#</a></h1>
<blockquote>
<div><p>COM6018</p>
</div></blockquote>
<p><em>Copyright © 2023, 2024 Jon Barker, University of Sheffield. All rights reserved</em>.</p>
<section id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<section id="what-is-pandas">
<h3>1.1 What is Pandas?<a class="headerlink" href="#what-is-pandas" title="Link to this heading">#</a></h3>
<p>So far in this module, we have seen how data can be processed very flexibly using native Python code and Python dictionary and list data structures. However, this flexibility comes at a cost: Processing data in this way can be slow and is not suitable for large datasets. We have also seen how using NumPy arrays allows us to process numeric data very efficiently. NumPy is excellent for mathematical computation, linear algebra, and a lot of the matrix/vector calculations that occur in machine learning. However, it is not so good for processing more complex structured data, which might have a mixture of data types (e.g., numeric, string, categorical, etc.) and missing values, etc. This is where <strong>Pandas</strong> comes in.</p>
<p><strong>Pandas</strong> is an open source 3rd party library designed for the needs of data scientists. It was originally built on top of NumPy, which allows it to be very fast, but it offers a lot of functionality for processing structured data that is not available in NumPy.</p>
<p>Although Pandas was originally built around NumPy, NumPy was not itself designed for this purpose, and that has led to some inefficiencies. However, Pandas has recently had a major new release (Pandas 2.0), which now allows the NumPy ‘backend’ to be replaced with one built around <a class="reference external" href="https://arrow.apache.org/">Apache Arrow</a> – a framework that has been designed from the ground-up for efficient processing of large table-like datasets.</p>
<p>This tutorial is based on Pandas 2.0. The complete documentation can be found at <a class="reference external" href="https://pandas.pydata.org/docs/">https://pandas.pydata.org/docs/</a>.</p>
</section>
<section id="installing-pandas">
<h3>1.2 Installing Pandas<a class="headerlink" href="#installing-pandas" title="Link to this heading">#</a></h3>
<p>As Pandas is not part of the Python standard library, it must first be installed before it can be used. This can be done easily using the <code class="docutils literal notranslate"><span class="pre">conda</span></code> package manager. (If you are using the Anaconda distribution of Python, then Pandas will already be installed. Or if you have built a conda environment using the <code class="docutils literal notranslate"><span class="pre">com6018.environment.yml</span></code> file provided with the module, then Pandas will also already be installed.)</p>
<p>If Pandas is not installed, you can install it by typing the following command in your terminal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># conda install -c conda-forge pandas</span>
</pre></div>
</div>
</div>
</div>
<p>This will install the latest version of Pandas.</p>
<p>To use Pandas in your Python code, you simply need to import it at the start of your program, e.g.,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>Conventional Python practice is to import Pandas using the alias <code class="docutils literal notranslate"><span class="pre">pd</span></code>. This is not essential, but it is recommended. Following existing conventions will make your code easier to read for other Python programmers.</p>
</section>
<section id="basic-pandas-concepts">
<h3>1.3 Basic Pandas Concepts<a class="headerlink" href="#basic-pandas-concepts" title="Link to this heading">#</a></h3>
<p>Pandas is designed for processing structured data much like the data that would be stored in a spreadsheet or a csv file. Pandas organises data using two basic data structures: the <strong>Series</strong> and the <strong>DataFrame</strong>. A <strong>Series</strong> is a one-dimensional array of data that can be thought of as a single column in a spreadsheet. A <strong>DataFrame</strong> represents a table of data, which is represented as a collection of <strong>Series</strong> objects. A <strong>DataFrame</strong> can be thought of as being similar to an entire spreadsheet.</p>
<p>Pandas has its own <strong>type system</strong> for representing data which is the same as that for NumPy but with a few extensions for representing things like dates and intervals. Every Series (i.e., spreadsheet column) will have its own type but there can be a different type for each Series.</p>
<p>Pandas offers a lot of functionality for processing data. This includes operations such as filtering tables, joining tables, grouping data, etc. It also includes a lot of functionality for reading and writing data in different formats such as CSV, Excel, JSON, SQL, etc. It also has some functionality for visualising data which is generally easier to use than the equivalent functionality in <code class="docutils literal notranslate"><span class="pre">Matplotlib</span></code>.</p>
</section>
</section>
<section id="reading-data">
<h2>2. Reading Data<a class="headerlink" href="#reading-data" title="Link to this heading">#</a></h2>
<p>Pandas has a range of methods for reading data from different standard data formats. For example, it can read Excel spreadsheets directly with a simple <code class="docutils literal notranslate"><span class="pre">read_excel()</span></code> method. However, continuing from our previous tutorials, we will focus on the commonly used CSV and JSON formats.</p>
<section id="reading-csv-data">
<h3>2.1 Reading CSV Data<a class="headerlink" href="#reading-csv-data" title="Link to this heading">#</a></h3>
<p>Reading a CSV file with Pandas can be done with a single line of code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/windfarm.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> function will parse the file and return the results as a Pandas DataFrame object. (It is common to use the variable name <code class="docutils literal notranslate"><span class="pre">df</span></code> for a DataFrame object in simple code examples. You may want to give the DataFrame a more descriptive name when writing more complex code.)</p>
<p>We can now print the resulting DataFrame object to see what it contains:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       id   &quot;turbines&quot;   &quot;height&quot;   &quot;power&quot;
0  WF1355           13         53   19500.0
1  WF1364            3         60    8250.0
2  WF1356           12         60   24000.0
3  WF1357           36         60   72000.0
</pre></div>
</div>
</div>
</div>
<p>This will produce output that looks like the following,</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>       id   &quot;turbines&quot;   &quot;height&quot;   &quot;power&quot;
0  WF1355           13         53     19500.0
1  WF1364            3         60      8250.0
2  WF1356           12         60     24000.0
3  WF1357           36         60     72000.0
</pre></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> function has read the names of the fields from the first line of the csv file and used these to name the DataFrame columns. If our csv file did not have column names in the first line, then we would need to specify them using the <code class="docutils literal notranslate"><span class="pre">names</span></code> parameter, e.g.,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/windfarm.no_names.csv&#39;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;turbines&#39;</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;power&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       id  turbines  height    power
0  WF1355        13      53  19500.0
1  WF1364         3      60   8250.0
2  WF1356        12      60  24000.0
3  WF1357        36      60  72000.0
</pre></div>
</div>
</div>
</div>
<p>Note also how Pandas has added an extra column without a title to the left of the data. This is known as the <strong>index column</strong>. The index column is used to uniquely identify each row in the DataFrame. Pandas has generated this index for us by giving the rows consecutive integer index values starting from 0. If we want to use a different column as the index, then we can specify this using the <code class="docutils literal notranslate"><span class="pre">index_col</span></code> parameter, e.g.,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_id</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/windfarm.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        &quot;turbines&quot;  &quot;height&quot;  &quot;power&quot;
id                                   
WF1355          13        53  19500.0
WF1364           3        60   8250.0
WF1356          12        60  24000.0
WF1357          36        60  72000.0
</pre></div>
</div>
</div>
</div>
<p>This will produce output looking like the following,</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>         &quot;turbines&quot;   &quot;height&quot;   &quot;power&quot;
id
WF1355           13         53   19500.0
WF1364            3         60    8250.0
WF1356           12         60   24000.0
WF1357           36         60   72000.0
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You typically want the values in the index column to be unique. If they are not unique, then Pandas will still allow you to use the column as the index, but it will not be able to use some of the more advanced functionality that it offers for indexing. If you are not sure about which column to use as the index, then it is often best not to specify one and to just allow Pandas to create its own index column.</p>
</div>
</section>
<section id="reading-json-data">
<h3>2.2 Reading JSON Data<a class="headerlink" href="#reading-json-data" title="Link to this heading">#</a></h3>
<p>Reading JSON data is just as easy as reading CSV data. We can read the climate JSON data from our previous tutorial with a single line of code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s1">&#39;data/climate.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can now print the resulting DataFrame object to see what it contains:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      id            city        country  \
0      1       Amsterdam    Netherlands   
1      2          Athens         Greece   
2      3      Atlanta GA  United States   
3      4        Auckland    New Zealand   
4      5       Austin TX  United States   
..   ...             ...            ...   
100  101  Albuquerque NM  United States   
101  102      Vermont IL  United States   
102  103    Nashville TE  United States   
103  104    St. Louis MO  United States   
104  105  Minneapolis MN  United States   

                                            monthlyAvg  
0    [{&#39;high&#39;: 7, &#39;low&#39;: 3, &#39;dryDays&#39;: 19, &#39;snowDay...  
1    [{&#39;high&#39;: 12, &#39;low&#39;: 7, &#39;dryDays&#39;: 21, &#39;snowDa...  
2    [{&#39;high&#39;: 12, &#39;low&#39;: 2, &#39;dryDays&#39;: 18, &#39;snowDa...  
3    [{&#39;high&#39;: 23, &#39;low&#39;: 16, &#39;dryDays&#39;: 24, &#39;snowD...  
4    [{&#39;high&#39;: 18, &#39;low&#39;: 6, &#39;dryDays&#39;: 15, &#39;snowDa...  
..                                                 ...  
100  [{&#39;high&#39;: 10, &#39;low&#39;: -4, &#39;dryDays&#39;: 24, &#39;snowD...  
101  [{&#39;high&#39;: 3, &#39;low&#39;: -8, &#39;dryDays&#39;: 18, &#39;snowDa...  
102  [{&#39;high&#39;: 9, &#39;low&#39;: -1, &#39;dryDays&#39;: 18, &#39;snowDa...  
103  [{&#39;high&#39;: 7, &#39;low&#39;: -4, &#39;dryDays&#39;: 16, &#39;snowDa...  
104  [{&#39;high&#39;: -3, &#39;low&#39;: -13, &#39;dryDays&#39;: 20, &#39;snow...  

[105 rows x 4 columns]
</pre></div>
</div>
</div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">monthlyAvg</span></code> data which was a list of dictionaries in the JSON file now appears in a single column of the DataFrame. This is not a very convenient format for processing the data. We can use a method called <code class="docutils literal notranslate"><span class="pre">apply()</span></code> to convert this column into a DataFrame with one column per each dictionary in the list. Using <code class="docutils literal notranslate"><span class="pre">apply()</span></code> a second time can then expand the dictionaries into columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_monthly</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;monthlyAvg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_monthly</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     high   low  dryDays  snowDays  rainfall
0     7.0   3.0     19.0       4.0      68.0
1    12.0   7.0     21.0       1.0      53.0
2    12.0   2.0     18.0       2.0      99.5
3    23.0  16.0     24.0       0.0      25.6
4    18.0   6.0     15.0       1.0      67.8
..    ...   ...      ...       ...       ...
100  10.0  -4.0     24.0       4.0      10.7
101   3.0  -8.0     18.0      11.0      52.1
102   9.0  -1.0     18.0       8.0      84.4
103   7.0  -4.0     16.0      10.0      69.8
104  -3.0 -13.0     20.0      16.0      19.9

[105 rows x 5 columns]
</pre></div>
</div>
</div>
</div>
<p>This is a little complicated, but it is typical of the preprocessing steps we might need to take if working with JSON files that have a complex nested structure. Fortunately, most of the data we will be working with will be in CSV format or in a simple JSON format with a flat structure.</p>
</section>
</section>
<section id="the-dataframe-object">
<h2>3. The DataFrame Object<a class="headerlink" href="#the-dataframe-object" title="Link to this heading">#</a></h2>
<p>We will now look in a bit more detail at the DataFrame object. For this section we will be using a dataset that records the extent of sea ice in the Arctic and Antarctic. This data is available from the <a class="reference external" href="https://nsidc.org/data/g02135">National Snow and Ice Data Center</a>. The data is available in CSV format and we have already downloaded it and saved it in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory as <code class="docutils literal notranslate"><span class="pre">seaice.csv</span></code>.</p>
<p>We will read the data and print the DataFrame,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/seaice.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Year   Month   Day       Extent      Missing  \
0      1978      10    26       10.231          0.0   
1      1978      10    28       10.420          0.0   
2      1978      10    30       10.557          0.0   
3      1978      11     1       10.670          0.0   
4      1978      11     3       10.777          0.0   
...     ...     ...   ...          ...          ...   
26349  2019       5    27       10.085          0.0   
26350  2019       5    28       10.078          0.0   
26351  2019       5    29       10.219          0.0   
26352  2019       5    30       10.363          0.0   
26353  2019       5    31       10.436          0.0   

                                             Source Data hemisphere  
0       [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsid...      north  
1       [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsid...      north  
2       [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsid...      north  
3       [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsid...      north  
4       [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsid...      north  
...                                                  ...        ...  
26349  [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...      south  
26350  [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...      south  
26351  [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...      south  
26352  [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...      south  
26353  [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...      south  

[26354 rows x 7 columns]
</pre></div>
</div>
</div>
</div>
<p>Note that when printing a DataFrame, Pandas will only show the first and last few rows and columns. We can see from the output that the DataFrame has 26354 rows and measurements that date back to 1978. But we cannot see the full set of columns.</p>
<p>To get a list of all the columns in the DataFrame, we can use the <code class="docutils literal notranslate"><span class="pre">columns</span></code> attribute,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Year&#39;, &#39; Month&#39;, &#39; Day&#39;, &#39;     Extent&#39;, &#39;    Missing&#39;, &#39; Source Data&#39;,
       &#39;hemisphere&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>This will produce output that looks like the following,</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Index([&#39;Year&#39;, &#39; Month&#39;, &#39; Day&#39;, &#39;     Extent&#39;, &#39;    Missing&#39;, &#39; Source Data&#39;,
       &#39;hemisphere&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
<p>We can now see that the data are composed of seven columns: year, month, day, extent, missing, source data, and hemisphere. The extent and missing columns record the extent of the sea ice and the number of missing measurements for each day. The source data column records the source of the data. The hemisphere column records whether the data are for the Arctic or Antarctic.</p>
<p>Note that space characters have become incorporated into the column names. This is because the columns in the CSV file had spaces after the commas. We can easily skip these spaces by adding the <code class="docutils literal notranslate"><span class="pre">skipinitialspace=True</span></code> parameter to the <code class="docutils literal notranslate"><span class="pre">read_csv()</span></code> method,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/seaice.csv&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Year&#39;, &#39;Month&#39;, &#39;Day&#39;, &#39;Extent&#39;, &#39;Missing&#39;, &#39;Source Data&#39;,
       &#39;hemisphere&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<section id="selecting-a-column">
<h3>3.1 Selecting a Column<a class="headerlink" href="#selecting-a-column" title="Link to this heading">#</a></h3>
<p>We can select a single column from the DataFrame using the column name as an index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">extent</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        10.231
1        10.420
2        10.557
3        10.670
4        10.777
          ...  
26349    10.085
26350    10.078
26351    10.219
26352    10.363
26353    10.436
Name: Extent, Length: 26354, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>This will produce output looking like the following,</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>0        10.231
1        10.420
2        10.557
3        10.670
4        10.777
          ...
26349    10.085
26350    10.078
26351    10.219
26352    10.363
26353    10.436
Name: Extent, Length: 26354, dtype: float64
</pre></div>
</div>
<p>Notice how this looks a bit different from when we printed the DataFrame. This is because the column is not a DataFrame, it is a Series. Remember, Pandas uses the Series object for storing individual columns of data. We can check this by printing the type of the column,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>  <span class="c1"># This will print &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>
<span class="n">extent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">extent</span><span class="p">))</span> <span class="c1"># This will print &lt;class &#39;pandas.core.series.Series&#39;&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
&lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>The Series object has a specific type (called its <code class="docutils literal notranslate"><span class="pre">dtype</span></code>). In this case the type is <code class="docutils literal notranslate"><span class="pre">float64</span></code> which means that the data is stored as 64-bit floating point numbers. We can check the type of the data in a Series using the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> attribute. Or, more conveniently, we can retrieve the data type of all the columns in the DataFrame using the DataFrame’s <code class="docutils literal notranslate"><span class="pre">dtypes</span></code> attribute. Let’s do that now,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year             int64
Month            int64
Day              int64
Extent         float64
Missing        float64
Source Data     object
hemisphere      object
dtype: object
</pre></div>
</div>
</div>
</div>
<p>This will produce output looking like the following,</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Year             int64
Month            int64
Day              int64
Extent         float64
Missing        float64
Source Data     object
hemisphere      object
dtype: object
</pre></div>
</div>
<p>We can see that the Year, Month and Day have integer values; the Extent and Missing columns have floating-point values; and the Source Data and hemisphere columns have ‘object’ values.</p>
<p>Pandas has inferred these types from the content of the csv file. It usually guesses correctly, but it can sometimes get it wrong. If it is unsure it will typically default to the ‘object’ type. This has happened for the ‘Source Data’ and ‘hemisphere’ columns which should be strings. We can fix this by explicitly converting these columns to strings using the <code class="docutils literal notranslate"><span class="pre">astype()</span></code> method,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Source Data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Source Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;hemisphere&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hemisphere&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year                    int64
Month                   int64
Day                     int64
Extent                float64
Missing               float64
Source Data    string[python]
hemisphere     string[python]
dtype: object
</pre></div>
</div>
</div>
</div>
<p>A Series object is much like a list, and we can use indexes and slicing operators to reference elements in the Series. For example, we can get the first element in the Series using,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># print the first element</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.231
</pre></div>
</div>
</div>
</div>
<p>or we can retrieve the sequence of elements from the 6th to 10th with,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">extent</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span> <span class="c1"># print a subseries from index 5 to 9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5    10.968
6    11.080
7    11.189
8    11.314
9    11.460
Name: Extent, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>(Recall that the first element of a series has index 0, so the 10th element has index 9. The slicing notation <code class="docutils literal notranslate"><span class="pre">a:b</span></code> means to go from index <code class="docutils literal notranslate"><span class="pre">a</span></code> to <code class="docutils literal notranslate"><span class="pre">b-1</span></code> inclusive.)</p>
</section>
<section id="selecting-a-row">
<h3>3.2 Selecting a Row<a class="headerlink" href="#selecting-a-row" title="Link to this heading">#</a></h3>
<p>We can select a single <em>row</em> from the DataFrame using the <code class="docutils literal notranslate"><span class="pre">iloc</span></code> attribute. This attribute takes a single integer index and returns a Series containing the data from the row at that index. For example, to select the first row, we can use,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year                                                        1978
Month                                                         10
Day                                                           26
Extent                                                    10.231
Missing                                                      0.0
Source Data    [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...
hemisphere                                                 north
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Notice how the results have been returned as a Series object. We can check this by printing the type of the row,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">row</span><span class="p">))</span> <span class="c1"># This will print &lt;class &#39;pandas.core.series.Series&#39;&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.series.Series&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>So DataFrames are a collection of Series objects representing the columns, but if we extract a single row, we get a Series object representing the row. The dtype of the row series is ‘object’. An object type can basically store anything, so it is being used here because each element in the row series has a different type.</p>
<p>Alternatively, we can extract a range of rows using slicing,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   Year  Month  Day  Extent  Missing  \
0  1978     10   26  10.231      0.0   
1  1978     10   28  10.420      0.0   
2  1978     10   30  10.557      0.0   
3  1978     11    1  10.670      0.0   
4  1978     11    3  10.777      0.0   

                                         Source Data hemisphere  
0  [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...      north  
1  [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...      north  
2  [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...      north  
3  [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...      north  
4  [&#39;ftp://sidads.colorado.edu/pub/DATASETS/nsidc...      north  
</pre></div>
</div>
</div>
</div>
<p>Note that a collection of rows is still a DataFrame. We can check this by printing the type of the variable <code class="docutils literal notranslate"><span class="pre">rows</span></code>,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">rows</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>Basically, if we have a single row or column, then we are dealing with a Series, but if we have multiple rows and columns, then we are dealing with a DataFrame.</p>
</section>
<section id="filtering-a-dataframe">
<h3>3.3 Filtering a DataFrame<a class="headerlink" href="#filtering-a-dataframe" title="Link to this heading">#</a></h3>
<p>Very often in data science, we need to select some subset of our data based on some condition, e.g., all cities where the population is greater than 1 million or all years where the average temperature was less than 15 degrees Celsius. Or, more simply, we may wish to select every row that has an even index value. Alternatively, we may want to remove various columns from the DataFrame, i.e., those representing fields that we are not interested in. We will refer to these operations that take a DataFrame and return another smaller DataFrame as <strong>filtering</strong> operations. In this section, we will look at a few simple examples.</p>
<section id="removing-or-selecting-columns">
<h4>3.3.1 Removing or Selecting Columns<a class="headerlink" href="#removing-or-selecting-columns" title="Link to this heading">#</a></h4>
<p>After loading our data, we may want to remove columns that we are not interested in. This is easily done using the <code class="docutils literal notranslate"><span class="pre">drop()</span></code> method. For example, to make it easier to print the data frame, we will remove the Source Data column using,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Source Data&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>There are now only 6 columns in the DataFrame and they can all be viewed at once,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Year  Month  Day  Extent  Missing hemisphere
0      1978     10   26  10.231      0.0      north
1      1978     10   28  10.420      0.0      north
2      1978     10   30  10.557      0.0      north
3      1978     11    1  10.670      0.0      north
4      1978     11    3  10.777      0.0      north
...     ...    ...  ...     ...      ...        ...
26349  2019      5   27  10.085      0.0      south
26350  2019      5   28  10.078      0.0      south
26351  2019      5   29  10.219      0.0      south
26352  2019      5   30  10.363      0.0      south
26353  2019      5   31  10.436      0.0      south

[26354 rows x 6 columns]
</pre></div>
</div>
</div>
</div>
<p>Rather than removing columns, an alternative is to actively select the subset of columns that we wish to keep. This is done with the following indexing notation,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Day&#39;</span><span class="p">,</span> <span class="s1">&#39;Extent&#39;</span><span class="p">,</span> <span class="s1">&#39;Missing&#39;</span><span class="p">,</span> <span class="s1">&#39;hemisphere&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="selecting-rows">
<h4>3.3.2 Selecting Rows<a class="headerlink" href="#selecting-rows" title="Link to this heading">#</a></h4>
<p>Very often when analysing data we want to select a subset of the samples entries that match some criterion, i.e., to select a subset of the rows in our DataFrame.  This is very straightforward in Pandas and is done using a Boolean expression as the index value.</p>
<p>For example, lets say we want to select all the rows where the sea ice extent value is less than 5.0. We can do this using,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selector</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">5.0</span>
<span class="n">df_low_extent</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">selector</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We have done this in two steps. The first line takes the Extent series and compares every value to 5.0. This produces a series of boolean (i.e, True or False) values which we have stored in a variable called <code class="docutils literal notranslate"><span class="pre">selector</span></code>. The second line uses this boolean series as an index which has the effect of selecting only the rows where the value is True.</p>
<p>If we now print the resulting DataFrame we can see that it only contains about 3000 rows of the original 26,354 rows in the dataset, i.e., these are the samples where the sea ice extent has fallen below 5.0 billion square kilometers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df_low_extent</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Year  Month  Day  Extent  Missing hemisphere
8874   2007      8   20   4.997      0.0      north
8875   2007      8   21   4.923      0.0      north
8876   2007      8   22   4.901      0.0      north
8877   2007      8   23   4.872      0.0      north
8878   2007      8   24   4.837      0.0      north
...     ...    ...  ...     ...      ...        ...
26296  2019      4    4   4.564      0.0      south
26297  2019      4    5   4.730      0.0      south
26298  2019      4    6   4.856      0.0      south
26299  2019      4    7   4.902      0.0      south
26300  2019      4    8   4.993      0.0      south

[2988 rows x 6 columns]
</pre></div>
</div>
</div>
</div>
<p>They are ordered by year. What do you notice about the earliest year of these data? Recall that the original complete dataset had recordings going back to 1979, but all the monthly recordings where the extent of the sea ice fallen below 5.0 billion square kilometers have occurred since 2007. Is this something that might have happened by chance, or is it evidence of a trend in the data? We will see how to answer such questions a little later in the module.</p>
<p>Let us say that we now just want to look at the Arctic data. We can do this by selecting only the rows where the hemisphere is ‘north’. We can do this using the <code class="docutils literal notranslate"><span class="pre">eq()</span></code> method,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">filter</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;hemisphere&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;north&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If we wanted to combine these two filters to select only the rows where the sea ice extent is less than 5.0 billion square kilometers and the hemisphere is ‘north’, we could do this using the <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> operator,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">filter</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;hemisphere&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="s1">&#39;north&#39;</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">5.0</span><span class="p">)</span>
<span class="n">df_low_extent_north</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="nb">filter</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df_low_extent_north</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Year  Month  Day  Extent  Missing hemisphere
8874   2007      8   20   4.997      0.0      north
8875   2007      8   21   4.923      0.0      north
8876   2007      8   22   4.901      0.0      north
8877   2007      8   23   4.872      0.0      north
8878   2007      8   24   4.837      0.0      north
...     ...    ...  ...     ...      ...        ...
12932  2018      9   29   4.846      0.0      north
12933  2018      9   30   4.875      0.0      north
12934  2018     10    1   4.947      0.0      north
12935  2018     10    2   4.988      0.0      north
12936  2018     10    3   4.975      0.0      north

[339 rows x 6 columns]
</pre></div>
</div>
</div>
</div>
<p>This leaves just 339 rows.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be careful to use parentheses around each filter expression above. The <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> operator has a higher precedence than the <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> operator so if you do not use parentheses then it will still be a valid the expression but it will not work in the way you expected.</p>
</div>
<p>Note that we use a very similar indexing syntax, i.e., <code class="docutils literal notranslate"><span class="pre">df[selector]</span></code>, for selecting both rows and columns. The difference is that when selecting rows we use a Boolean series as the index value, whereas when selecting columns we use a list of column names as the index value. This can be a little confusing at first, but you will soon get used to it.</p>
</section>
</section>
</section>
<section id="grouping-and-averaging-values">
<h2>4 Grouping and averaging values<a class="headerlink" href="#grouping-and-averaging-values" title="Link to this heading">#</a></h2>
<section id="operating-on-columns">
<h3>4.1 Operating on columns<a class="headerlink" href="#operating-on-columns" title="Link to this heading">#</a></h3>
<p>There are many operations that we might apply over an entire column to compute some ‘statistic’ of that column. For example, we might want to compute a columns minimum, maximum, mean, median, standard deviation, etc. The Series object provides many methods to make this easy.</p>
<p>For example, to compute the mean of the Extent column we can use,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_value</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.494986301889654
</pre></div>
</div>
</div>
</div>
<p>We can also calculate the minimum and maximum values in a similar way,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.08 20.201
</pre></div>
</div>
</div>
</div>
<p>For convenience, the DataFrame object provides a <code class="docutils literal notranslate"><span class="pre">describe()</span></code> method that will compute and display the basic statistics for all columns in the DataFrame that have numerical values. For example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Year         Month           Day        Extent       Missing
count  26354.000000  26354.000000  26354.000000  26354.000000  26354.000000
mean    2000.591941      6.507399     15.740685     11.494986      0.000003
std       10.896821      3.451938      8.801607      4.611734      0.000227
min     1978.000000      1.000000      1.000000      2.080000      0.000000
25%     1992.000000      4.000000      8.000000      7.601000      0.000000
50%     2001.000000      7.000000     16.000000     12.217000      0.000000
75%     2010.000000     10.000000     23.000000     15.114000      0.000000
max     2019.000000     12.000000     31.000000     20.201000      0.024000
</pre></div>
</div>
</div>
</div>
<p>This will print the following table:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>               Year         Month           Day        Extent       Missing
count  26354.000000  26354.000000  26354.000000  26354.000000  26354.000000
mean    2000.591941      6.507399     15.740685     11.494986      0.000003
std       10.896821      3.451938      8.801607      4.611734      0.000227
min     1978.000000      1.000000      1.000000      2.080000      0.000000
25%     1992.000000      4.000000      8.000000      7.601000      0.000000
50%     2001.000000      7.000000     16.000000     12.217000      0.000000
75%     2010.000000     10.000000     23.000000     15.114000      0.000000
max     2019.000000     12.000000     31.000000     20.201000      0.024000
</pre></div>
</div>
<p>The table shows the number of items (count), mean, standard deviation (std), minimum (min), maximum (max) and the 25th, 50th, and 75th percentiles of the data in each column. Note that the 50th percentile is the same as the median. These statistics will be more meaningful for some columns than for others. For example, in the above the mean and standard deviation of the Month and Day columns are not very meaningful. Nevertheless, the <code class="docutils literal notranslate"><span class="pre">describe()</span></code> methods is very useful for getting a quick overview of the data and is often the first thing we will do when we load a new dataset.</p>
</section>
<section id="grouping-data">
<h3>4.2 Grouping data<a class="headerlink" href="#grouping-data" title="Link to this heading">#</a></h3>
<p>In the above, we have computed the statistics of the entire data set. It is more common to want to compute statistics after grouping the data into meaningful subsets. For example, we might be interested in the mean sea ice extent for each year, or for each month, or for the north and south hemispheres, separately. To compute such statistics, we need to group the data into subsets and then compute the statistics for each subset.</p>
<p>Grouping the data is done using the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method. For example, to group the data by month we can use</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Month&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This returns a special <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> object. This object is a special type of DataFrame that contains the data grouped by the column we specified. We can then compute statistics on groups by selecting a column and using the same methods that we used earlier. For example, to compute the mean sea ice extent for each month we can use</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Month
1      9.587706
2      9.057401
3      9.621926
4     10.678099
5     11.637163
6     12.476158
7     12.563403
8     12.288473
9     12.265863
10    13.044214
11    13.152069
12    11.514823
Name: Extent, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The code above has produced a mean value for each month of the year (1 is January, 2 is February, etc.). Notice how the amount of ice reaches a maximum in November and a minimum in February. This might seem somewhat surprising to you, e.g., the maximum and minimum are not six months apart, as might be expected. Note, however, that when we grouped by month we included both Northern and Southern hemisphere measurements, so this mean will be the average across both hemispheres, and this can lead to an unintuitive outcome.</p>
<p>Let us say that we wanted to look at the sea ice extent for each month but separately for the northern and southern hemisphere. We now want to group by both month and hemisphere. We can do this easily by passing a list of column names to the <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;hemisphere&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>hemisphere  Month
north       1        14.176006
            2        15.044512
            3        15.205876
            4        14.481141
            5        13.072172
            6        11.516788
            7         9.090173
            8         6.784248
            9         5.988981
            10        7.929377
            11       10.448120
            12       12.638618
south       1         4.999406
            2         3.070290
            3         4.037976
            4         6.875058
            5        10.202155
            6        13.435529
            7        16.036633
            8        17.792698
            9        18.542745
            10       18.159051
            11       15.856019
            12       10.391028
Name: Extent, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Note that when printing out a DataFrameGroupBy object that has been grouped by multiple fields, Pandas will produce a multicolumn table with the first column being the first field in the groupby list, the second column being the second field in the groupby list, etc. In this case, the first column is the hemisphere, and the second column is the month.</p>
<p>We now see that in the Arctic, sea ice reaches a maximum in March and a minimum in September. In the Antarctic, sea ice reaches a maximum in September and a minimum in February. This is more in line with what we might expect, that is, the maxima and minima are about 6 months apart. The dates might seem a little later than what you would consider to be the peak of winter and summer. This is because of the way water stores heat. The oceans take a long time to cool down and warm up, so the coldest and warmest months are not the same as the months with the shortest and longest days. You can now also see that the Antarctic sea ice extent is much more variable than the Arctic sea ice extent.</p>
<p>Let us now consider how we would examine the Arctic and Antarctic sea ice minimum over the years. We can do this by grouping by hemisphere and year and then selecting the minimum value in each group,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;hemisphere&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>hemisphere  Year
north       1978    10.231
            1979     6.895
            1980     7.533
            1981     6.902
            1982     7.160
                     ...  
south       2015     3.544
            2016     2.616
            2017     2.080
            2018     2.150
            2019     2.444
Name: Extent, Length: 84, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Pandas has built-in methods to make plots. Below we are making a plot and then getting the <code class="docutils literal notranslate"><span class="pre">figure</span></code> from the plot and saving it to a file. The resulting plot is being imported back into these notes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;hemisphere&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>
<span class="n">ice_extent</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()[</span><span class="s1">&#39;north&#39;</span><span class="p">]</span>

<span class="n">my_plot</span> <span class="o">=</span> <span class="n">ice_extent</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/040_1.jpeg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/45b95dc98db0deeb8285cf736e4ce4339f53feabc8c9f669c2c28fe419ce2640.png" src="../../_images/45b95dc98db0deeb8285cf736e4ce4339f53feabc8c9f669c2c28fe419ce2640.png" />
</div>
</div>
<p>You can see that the sea ice extent has been broadly trending downwards but the values at the extremes of the x-axis look a bit odd, i.e., there are very large values for the first and last year in the dataset. This is an ‘artifact’ caused by the data for these years being incomplete. The data for 1978 only start in November and the data for 2019 only go up to July. The code has computed the average for the few months that are available, but this is not representative of the average for the full year. We can fix this problem by simply removing these years from the data before plotting.</p>
<p>To remove the first and last values in a series we can use the familiar slicing notation that we saw when using NumPy, ‘[1:-1]’. So, the code will now look like</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;hemisphere&#39;</span><span class="p">,</span> <span class="s1">&#39;Year&#39;</span><span class="p">])</span>
<span class="n">ice_extent</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s1">&#39;Extent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()[</span><span class="s1">&#39;north&#39;</span><span class="p">]</span>
<span class="n">ice_extent</span> <span class="o">=</span> <span class="n">ice_extent</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># remove first and last years</span>

<span class="n">my_plot</span> <span class="o">=</span> <span class="n">ice_extent</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Arctic sea ice minimum&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;million square km&#39;</span><span class="p">)</span>
<span class="n">my_plot</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;figures/040_2.jpeg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9cc02b6c44b70efb9a676d2a508276ca927007426f81df2627ea950da8fb3abf.png" src="../../_images/9cc02b6c44b70efb9a676d2a508276ca927007426f81df2627ea950da8fb3abf.png" />
</div>
</div>
<p>Notice how the sea ice minimum fluctuates seemingly at random from year to year. This kind of unexplained variation in data is often referred to as noise. However, ignoring the fluctuations, we can see that there also appears to be a downward trend in the sea ice minimum. If we want to be sure that there is a genuine downward trend and that the low values in recent years are not just part of the usual random fluctuations, then we need to perform some statistical analysis. We will look at how to do this later in the module.</p>
</section>
</section>
<section id="dealing-with-missing-data">
<h2>5 Dealing with Missing Data<a class="headerlink" href="#dealing-with-missing-data" title="Link to this heading">#</a></h2>
<p>Very often we need to work with data sets that have ‘missing values’, i.e., for one or more fields in the data there is no value available. These are typically encoded in the data file using a special symbol such as ‘NaN’. For example, we may have some employee data that records an ID, a surname and age, and a gender, but there may be some employees that have not provided either their age or gender or both.</p>
<p>We can read and display some example data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/employee.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note, below, the presence of ‘NaN’ in the age and gender columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ID    Surname   Age  Gender
0   1      Smith  32.0    Male
1   2    Johnson  45.0  Female
2   3   Gonzalez   NaN     NaN
3   4         Li  37.0  Female
4   5      Brown  41.0    Male
5   6  Rodriguez  29.0  Female
6   7      Kumar  32.0     NaN
7   8      Lopez  36.0  Female
8   9     Nguyen   NaN    Male
9  10      Patel  40.0    Male
</pre></div>
</div>
</div>
</div>
<p>There are some simple functions to test for the presence of these missing values. For example, the <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> method will produce a new dataframe of boolean values with a value of True in every location where an item of data is missing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      ID  Surname    Age  Gender
0  False    False  False   False
1  False    False  False   False
2  False    False   True    True
3  False    False  False   False
4  False    False  False   False
5  False    False  False   False
6  False    False  False    True
7  False    False  False   False
8  False    False   True   False
9  False    False  False   False
</pre></div>
</div>
</div>
</div>
<p>Typically if we have missing values we will need to take some action to deal with them before progressing with our analysis. Depending on the situation, the most appropriate action might be to simply remove the rows with missing values, or to fill in the missing values with some sensible default value, or to use some more sophisticated method for estimating what the missing values would have been if they had been present.</p>
<section id="filling-missing-data-with-a-fixed-value">
<h3>5.1 Filling missing data with a fixed value<a class="headerlink" href="#filling-missing-data-with-a-fixed-value" title="Link to this heading">#</a></h3>
<p>We can fill in missing values using the <code class="docutils literal notranslate"><span class="pre">fillna</span></code> method. For example, if displaying the data, we may simply want to replace the Gender NaNs with something more readable, such as ‘Gender not provided.’ This is done as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Gender&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s2">&quot;Gender not provided&quot;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2078/1817109800.py:1: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df[&#39;Gender&#39;].fillna(&quot;Gender not provided&quot;, inplace = True)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ID    Surname   Age               Gender
0   1      Smith  32.0                 Male
1   2    Johnson  45.0               Female
2   3   Gonzalez   NaN  Gender not provided
3   4         Li  37.0               Female
4   5      Brown  41.0                 Male
5   6  Rodriguez  29.0               Female
6   7      Kumar  32.0  Gender not provided
7   8      Lopez  36.0               Female
8   9     Nguyen   NaN                 Male
9  10      Patel  40.0                 Male
</pre></div>
</div>
</div>
</div>
<p>Note the parameter <code class="docutils literal notranslate"><span class="pre">inplace</span> <span class="pre">=</span> <span class="pre">True</span></code>. This tells Pandas to modify the DataFrame ‘in place’ rather than making and returning a modified copy of the original DataFrame (which is what happens when you set <code class="docutils literal notranslate"><span class="pre">inplace</span> <span class="pre">=</span> <span class="pre">False</span></code>, or use the default behaviour). This ‘in place’ modification is a common pattern in Pandas and many methods have this <code class="docutils literal notranslate"><span class="pre">inplace</span></code> parameter. For large DataFrames, it is often desirable to modify the DataFrame in place to avoid the memory overhead of creating a new DataFrame. However, it can be a dangerous style of programming that can lead to subtle errors. For example, if we have a function that modifies a DataFrame in place but which also returns the modified DataFrame, then the user of the function may be unaware that the DataFrame they are passing as a parameter is going to be changed by the function. This unexpected behaviour can easily lead to bugs. It is often better to leave the <code class="docutils literal notranslate"><span class="pre">inplace</span></code> attribute set to False and to assign the result of the method to a new variable. This is a safer style of programming and should be preferred unless you are sure that it is causing a performance problem.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">fillna</span></code> method has other useful options such as a <code class="docutils literal notranslate"><span class="pre">method</span></code> parameter that can fill the missing value with the previous or next valid observation in the Series. This behaviour is useful for sequential data, e.g., data ordered by date, for example. For example, if there is a weather station but it has failed to record a temperature on a particular day, then we might opt to fill in the missing value with the temperature recorded on the previous day as this is likely to be a reasonably good estimate.</p>
</section>
<section id="filling-missing-values-using-mean-imputation">
<h3>5.2 Filling missing values using ‘mean imputation’<a class="headerlink" href="#filling-missing-values-using-mean-imputation" title="Link to this heading">#</a></h3>
<p>Another common strategy for filling missing values in numeric data is to fill the missing values with the mean of the values that are present. In the data science literature, this is known as ‘mean imputation’. This might be a sensible way of treating our missing employee age data and can be easily done using,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2078/2940318962.py:1: FutureWarning: A value is trying to be set on a copy of a DataFrame or Series through chained assignment using an inplace method.
The behavior will change in pandas 3.0. This inplace method will never work because the intermediate object on which we are setting values always behaves as a copy.

For example, when doing &#39;df[col].method(value, inplace=True)&#39;, try using &#39;df.method({col: value}, inplace=True)&#39; or df[col] = df[col].method(value) instead, to perform the operation inplace on the original object.


  df[&#39;Age&#39;].fillna(df[&#39;Age&#39;].mean(), inplace = True)
</pre></div>
</div>
</div>
</div>
<p>This will produce the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   ID    Surname   Age               Gender
0   1      Smith  32.0                 Male
1   2    Johnson  45.0               Female
2   3   Gonzalez  36.5  Gender not provided
3   4         Li  37.0               Female
4   5      Brown  41.0                 Male
5   6  Rodriguez  29.0               Female
6   7      Kumar  32.0  Gender not provided
7   8      Lopez  36.0               Female
8   9     Nguyen  36.5                 Male
9  10      Patel  40.0                 Male
</pre></div>
</div>
</div>
</div>
<p>Note how the missing age values for Gonzalez and Nguyen have now been replaced with 36.5.  Obviously, this is unlikely to be their true ages, but it might be a sensible guess to use in the analysis stages that are going to follow.</p>
<p>Treatment of missing data is a big topic and something we will return to later in the module.</p>
</section>
</section>
<section id="collating-data">
<h2>6 Collating data<a class="headerlink" href="#collating-data" title="Link to this heading">#</a></h2>
<p>Very often, as Data Scientists, we need to combine data from different sources. For example, we might have two separate datasets that are linked by a shared field, such as the customer ID, date, or location. These will typically start lief as separate files. These can be read into two separate DataFrames but in order to understand the data we will generally need to combine these DataFrames into a new common DataFrame, in some way.</p>
<p>In the simple example below, we will consider two different sets of atmospheric gas readings, carbon dioxide and methane that have been measured at the same location over time but are stored separately in the files <code class="docutils literal notranslate"><span class="pre">co2.csv</span></code> and <code class="docutils literal notranslate"><span class="pre">ch4.csv</span></code>. (The file names are based on the chemical formulae for carbon dioxide and methane, CO<sub>2</sub> and CH<sub>4</sub>, respectively).</p>
<p>Let us imagine that the first few rows of these tables look like this</p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>year, month, day, co2
2020, 1, 02, 442
2020, 1, 03, 444
2020, 1, 04, 441
2020, 1, 07, 446
</pre></div>
</div>
<p>and this,</p>
<div class="highlight-csv notranslate"><div class="highlight"><pre><span></span>year, month, day, ch4
2020, 1, 02, 442
2020, 1, 03, 444
2020, 1, 05, 441
2020, 1, 06, 442
2020, 1, 07, 446
</pre></div>
</div>
<p>We can see that both tables share the same year, month and day columns but each have their own unique column for the gas concentration measurement. We can also see that the data are not recorded on every day: on some days there is both a carbon dioxide and a methane measurement, on some there is only one or the other and on some dates there is neither. We will now consider different ways in which these datasets can be combined.</p>
<section id="combining-dataframes-using-the-merge-method">
<h3>6.1 Combining DataFrames using the <code class="docutils literal notranslate"><span class="pre">merge</span></code> method<a class="headerlink" href="#combining-dataframes-using-the-merge-method" title="Link to this heading">#</a></h3>
<p>To make the task a bit more instructive, the above data have some missing entries, e.g., entries for days 05 and 06 are missing from the CO<sub>2</sub> data. The entry for day 04 is missing from the CH<sub>4</sub> data. In a well-designed dataset these might have been recorded with NaN values but often there are just gaps in the data.</p>
<p>We can read these tables using,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/co2_ex.csv&#39;</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ch4_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/ch4_ex.csv&#39;</span><span class="p">,</span>  <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">co2_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ch4_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   year  month  day  co2
0  2020      1    2  442
1  2020      1    3  444
2  2020      1    4  441
3  2020      1    7  446
   year  month  day  ch4
0  2020      1    2  442
1  2020      1    3  444
2  2020      1    5  441
3  2020      1    6  442
4  2020      1    7  446
</pre></div>
</div>
</div>
</div>
<p>We can now <code class="docutils literal notranslate"><span class="pre">merge</span></code> the tables. To do this, we need to pick a column to <strong>merge on</strong>. This is typically a key-like value that uniquely identifies the data entry (i.e., the row) and appears in both tables. If no one column is unique then we can use a collection of columns to merge on. For example, in our data, neither the year, month nor day would be a unique identifier if taken in isolation, but the three together form a unique set of values (i.e., because there is only one measurement per day, no two rows have an identical year, month and day). So we will use <code class="docutils literal notranslate"><span class="pre">on=['year',</span> <span class="pre">'month',</span> <span class="pre">'day']</span></code>.</p>
<p>We can then merge in four different ways: <code class="docutils literal notranslate"><span class="pre">inner</span></code>, <code class="docutils literal notranslate"><span class="pre">outer</span></code>, <code class="docutils literal notranslate"><span class="pre">left</span></code> or <code class="docutils literal notranslate"><span class="pre">right</span></code>. These differ in how they treat missing values: <code class="docutils literal notranslate"><span class="pre">inner</span></code> will only merge rows in which the row exists in both DataFrames (i.e., if you think of this a merging two <em>sets</em> then this would be an ‘intersection’); <code class="docutils literal notranslate"><span class="pre">outer</span></code> will include rows that exist in either of the two DataFrames (i.e., in terms of sets, this would be a ‘union’); <code class="docutils literal notranslate"><span class="pre">left</span></code> only includes rows which are in the first DataFrame and <code class="docutils literal notranslate"><span class="pre">right</span></code> only those in the second. This can be most easily understood by comparing the outputs below.</p>
<ul class="simple">
<li><p>Merging CO<sub>2</sub> and CH<sub>4</sub> using an <code class="docutils literal notranslate"><span class="pre">inner</span></code> merge:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined_df</span> <span class="o">=</span> <span class="n">co2_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ch4_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">combined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   year  month  day  co2  ch4
0  2020      1    2  442  442
1  2020      1    3  444  444
2  2020      1    7  446  446
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Merging CO<sub>2</sub> and CH<sub>4</sub> using an <code class="docutils literal notranslate"><span class="pre">outer</span></code> merge:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined_df</span> <span class="o">=</span> <span class="n">co2_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ch4_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">combined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   year  month  day    co2    ch4
0  2020      1    2  442.0  442.0
1  2020      1    3  444.0  444.0
2  2020      1    4  441.0    NaN
3  2020      1    5    NaN  441.0
4  2020      1    6    NaN  442.0
5  2020      1    7  446.0  446.0
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Merging CO<sub>2</sub> and CH<sub>4</sub> using a <code class="docutils literal notranslate"><span class="pre">left</span></code> merge:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined_df</span> <span class="o">=</span> <span class="n">co2_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ch4_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">combined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   year  month  day  co2    ch4
0  2020      1    2  442  442.0
1  2020      1    3  444  444.0
2  2020      1    4  441    NaN
3  2020      1    7  446  446.0
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Merging CO<sub>2</sub> and CH<sub>4</sub> using a <code class="docutils literal notranslate"><span class="pre">right</span></code> merge:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined_df</span> <span class="o">=</span> <span class="n">co2_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ch4_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">combined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   year  month  day    co2  ch4
0  2020      1    2  442.0  442
1  2020      1    3  444.0  444
2  2020      1    5    NaN  441
3  2020      1    6    NaN  442
4  2020      1    7  446.0  446
</pre></div>
</div>
</div>
</div>
<p>In all cases, in the resulting table, any missing values will be automatically filled in with NaNs.</p>
<p>Warning:</p>
<p>Typically, the join columns act as a unique key. What happens if we choose columns that are not unique? Below we attempt to join on the ‘year’ column which is actually the same for all our rows, i.e.,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined_df</span> <span class="o">=</span> <span class="n">co2_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ch4_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">combined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    year  month_x  day_x  co2  month_y  day_y  ch4
0   2020        1      2  442        1      2  442
1   2020        1      2  442        1      3  444
2   2020        1      2  442        1      5  441
3   2020        1      2  442        1      6  442
4   2020        1      2  442        1      7  446
5   2020        1      3  444        1      2  442
6   2020        1      3  444        1      3  444
7   2020        1      3  444        1      5  441
8   2020        1      3  444        1      6  442
9   2020        1      3  444        1      7  446
10  2020        1      4  441        1      2  442
11  2020        1      4  441        1      3  444
12  2020        1      4  441        1      5  441
13  2020        1      4  441        1      6  442
14  2020        1      4  441        1      7  446
15  2020        1      7  446        1      2  442
16  2020        1      7  446        1      3  444
17  2020        1      7  446        1      5  441
18  2020        1      7  446        1      6  442
19  2020        1      7  446        1      7  446
</pre></div>
</div>
</div>
</div>
<p>This has taken the set of rows from each table that share the same year and made new rows using every possible pairing of rows in these sets. Also because ‘month’ and ‘day’ were not in the join, the new DataFrame now has separate month and day columns coming from the two original DataFrames which have been automatically distinguished with the suffixes ‘_x’ and ‘_y’.  There are actually instances when we might want this behaviour, but if your output is looking like this, it is more likely that it’s because you have set the <code class="docutils literal notranslate"><span class="pre">on</span></code> parameter incorrectly.</p>
</section>
<section id="combining-dataframes-using-the-join-method">
<h3>6.2 Combining DataFrames using the <code class="docutils literal notranslate"><span class="pre">join</span></code> method<a class="headerlink" href="#combining-dataframes-using-the-join-method" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">join</span></code> function is very similar to <code class="docutils literal notranslate"><span class="pre">merge</span></code> except that it uses the DataFrame index to decide which rows to combine. It can be thought of as a special case of <code class="docutils literal notranslate"><span class="pre">merge</span></code>, however, it is often more convenient and faster to use. If the DataFrame already has a meaningful index, then this is very easy to use; e.g., perhaps a product ID column is being used as the index and we have two DataFrames containing product sales for different product ranges that we wish to join.</p>
<p>In our case, if working with the CO<sub>2</sub> and CH<sub>4</sub> data from above, in order to use join, we would first need to make an index using the year, month, and day columns. We can do this using the <code class="docutils literal notranslate"><span class="pre">set_index</span></code> method, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_df_indexed</span> <span class="o">=</span> <span class="n">co2_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">])</span>
<span class="n">ch4_df_indexed</span> <span class="o">=</span> <span class="n">ch4_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">co2_df_indexed</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ch4_df_indexed</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                co2
year month day     
2020 1     2    442
           3    444
           4    441
           7    446
                ch4
year month day     
2020 1     2    442
           3    444
           5    441
           6    442
           7    446
</pre></div>
</div>
</div>
</div>
<p>We can now perform the join. Again, as with merge, we can join using <code class="docutils literal notranslate"><span class="pre">inner</span></code>, <code class="docutils literal notranslate"><span class="pre">outer</span></code>, <code class="docutils literal notranslate"><span class="pre">left</span></code> or <code class="docutils literal notranslate"><span class="pre">right</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined_df</span> <span class="o">=</span> <span class="n">co2_df_indexed</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ch4_df_indexed</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">combined_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                  co2    ch4
year month day              
2020 1     2    442.0  442.0
           3    444.0  444.0
           4    441.0    NaN
           5      NaN  441.0
           6      NaN  442.0
           7    446.0  446.0
</pre></div>
</div>
</div>
</div>
<p>Comparing <code class="docutils literal notranslate"><span class="pre">merge</span></code> and <code class="docutils literal notranslate"><span class="pre">join</span></code>, <code class="docutils literal notranslate"><span class="pre">merge</span></code> is more versatile because it can merge on any column, whereas join can only merge on the index. So you might wonder why we have a <code class="docutils literal notranslate"><span class="pre">join</span></code> method at all? The answer is that the <code class="docutils literal notranslate"><span class="pre">join</span></code> method works internally in a very different way than <code class="docutils literal notranslate"><span class="pre">merge</span></code> that exploits special properties of the DataFrame index. For large DataFrames, <code class="docutils literal notranslate"><span class="pre">join</span></code> is generally much faster than <code class="docutils literal notranslate"><span class="pre">merge</span></code> and so should be preferred if its use is possible.</p>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>Pandas is a large and sophisticated package for working with data. In this tutorial, we have used it to read data, to deal with missing values, to conditionally filter data, to compute statistic on fields with and without prior grouping, and to combine datasets using merge and join. This is a good overview of the most commonly used functionality, but only scratches the surface of what Pandas can do. There are entire books dedicated to Pandas and extensive documentation available online: it is a very useful tool to have in your toolbox. We will be using it throughout the rest of the module and will introduce new functionality as required.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./materials/tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="035_Some_Common_Problems.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">035 Some Common Problems</p>
      </div>
    </a>
    <a class="right-next"
       href="045_Common_Pandas_Mistakes.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">045 Common Pandas Mistakes</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-pandas">1.1 What is Pandas?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installing-pandas">1.2 Installing Pandas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-pandas-concepts">1.3 Basic Pandas Concepts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-data">2. Reading Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-csv-data">2.1 Reading CSV Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-json-data">2.2 Reading JSON Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-dataframe-object">3. The DataFrame Object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-a-column">3.1 Selecting a Column</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-a-row">3.2 Selecting a Row</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-a-dataframe">3.3 Filtering a DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-or-selecting-columns">3.3.1 Removing or Selecting Columns</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#selecting-rows">3.3.2 Selecting Rows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-and-averaging-values">4 Grouping and averaging values</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operating-on-columns">4.1 Operating on columns</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouping-data">4.2 Grouping data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dealing-with-missing-data">5 Dealing with Missing Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filling-missing-data-with-a-fixed-value">5.1 Filling missing data with a fixed value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filling-missing-values-using-mean-imputation">5.2 Filling missing values using ‘mean imputation’</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#collating-data">6 Collating data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-dataframes-using-the-merge-method">6.1 Combining DataFrames using the <code class="docutils literal notranslate"><span class="pre">merge</span></code> method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combining-dataframes-using-the-join-method">6.2 Combining DataFrames using the <code class="docutils literal notranslate"><span class="pre">join</span></code> method</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jon Barker, University of Sheffield
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023, 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>